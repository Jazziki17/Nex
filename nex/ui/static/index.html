<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEX</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Boot Sequence Overlay -->
    <div id="boot-sequence" class="boot-sequence">
        <canvas id="matrix-rain-canvas" class="boot-canvas"></canvas>
        <div id="boot-terminal" class="boot-terminal"></div>
        <canvas id="boot-particle-canvas" class="boot-canvas"></canvas>
        <div class="boot-skip">PRESS ANY KEY TO SKIP</div>
    </div>

    <!-- Background Matrix Rain (subtle, always running) -->
    <canvas id="bg-matrix-canvas" class="bg-matrix-canvas"></canvas>

    <canvas id="canvas"></canvas>

    <!-- Left Sidebar Nav -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-top">
            <button class="sidebar-btn active" data-view="orb">
                <svg viewBox="0 0 24 24" width="18" height="18"><circle cx="12" cy="12" r="8" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
                <span class="sidebar-tooltip">Orb</span>
            </button>
            <button class="sidebar-btn" data-view="dashboard">
                <svg viewBox="0 0 24 24" width="18" height="18"><rect x="3" y="3" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="14" y="3" width="7" height="4" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="14" y="11" width="7" height="10" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="3" y="14" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
                <span class="sidebar-tooltip">Dashboard</span>
            </button>
            <button class="sidebar-btn" data-view="services">
                <svg viewBox="0 0 24 24" width="18" height="18"><circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
                <span class="sidebar-tooltip">Services</span>
            </button>
            <button class="sidebar-btn" data-view="logs">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                <span class="sidebar-tooltip">Logs</span>
            </button>
            <button class="sidebar-btn" data-view="vision">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                <span class="sidebar-tooltip">Vision</span>
            </button>
            <button class="sidebar-btn" data-view="settings">
                <svg viewBox="0 0 24 24" width="18" height="18"><circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                <span class="sidebar-tooltip">Settings</span>
            </button>
        </div>
        <div class="sidebar-bottom">
            <button class="sidebar-btn" id="workspace-toggle-btn">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="3" width="20" height="18" rx="2"/><line x1="9" y1="3" x2="9" y2="21"/></svg>
                <span class="sidebar-tooltip">Workspace</span>
            </button>
            <button class="sidebar-btn" id="history-toggle-btn">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                <span class="sidebar-tooltip">History</span>
            </button>
            <button class="sidebar-btn" id="fullscreen-btn">
                <svg id="fs-expand-icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg>
                <svg id="fs-shrink-icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5" style="display:none"><polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" y1="10" x2="21" y2="3"/><line x1="3" y1="21" x2="10" y2="14"/></svg>
                <span class="sidebar-tooltip">Fullscreen</span>
            </button>
        </div>
    </nav>

    <!-- Status text -->
    <div class="status" id="status">LISTENING</div>

    <!-- Mic level indicator -->
    <div class="audio-meter" id="audio-meter">
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
    </div>

    <!-- Transcript overlay -->
    <div class="transcript" id="transcript"></div>

    <!-- Command input -->
    <div class="command-bar" id="command-bar">
        <input type="text" id="command-input" placeholder="Type a command..." autocomplete="off" spellcheck="false">
    </div>

    <!-- Conversation Feed (top-left, always visible on dashboard) -->
    <div class="conversation-feed" id="conversation-feed"></div>

    <!-- Dashboard View -->
    <div class="view-overlay" id="dashboard-view">
        <div class="dashboard-grid">
            <div class="stat-card" id="card-cpu">
                <div class="stat-label">CPU</div>
                <div class="stat-value" id="stat-cpu">0%</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-cpu"></div></div>
                <div class="stat-sub" id="sub-cpu">&mdash; cores</div>
            </div>
            <div class="stat-card" id="card-memory">
                <div class="stat-label">MEMORY</div>
                <div class="stat-value" id="stat-memory">0%</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-memory"></div></div>
                <div class="stat-sub" id="sub-memory">&mdash; / &mdash; GB</div>
            </div>
            <div class="stat-card" id="card-disk">
                <div class="stat-label">DISK</div>
                <div class="stat-value" id="stat-disk">0%</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-disk"></div></div>
                <div class="stat-sub" id="sub-disk">&mdash; / &mdash; GB</div>
            </div>
            <div class="stat-card" id="card-battery">
                <div class="stat-label">BATTERY</div>
                <div class="stat-value" id="stat-battery">&mdash;</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-battery"></div></div>
                <div class="stat-sub" id="sub-battery">&mdash;</div>
            </div>
            <div class="stat-card wide" id="card-network">
                <div class="stat-label">NETWORK</div>
                <div class="stat-value" id="stat-network">&mdash; / &mdash;</div>
                <div class="stat-sub" id="sub-network">sent / received</div>
            </div>
        </div>
        <div class="transcript-panel">
            <div class="panel-label">RECENT</div>
            <div class="transcript-list" id="dashboard-transcript"></div>
        </div>
    </div>

    <!-- Services View -->
    <div class="view-overlay" id="services-view">
        <div class="view-title">SERVICES</div>
        <div class="services-list" id="services-list">
            <div class="services-loading">Loading modules...</div>
        </div>
    </div>

    <!-- Logs View -->
    <div class="view-overlay" id="logs-view">
        <div class="logs-header">
            <div class="view-title">LOGS</div>
            <select id="log-filter" class="log-filter-select">
                <option value="all">All</option>
                <option value="system.command">Commands</option>
                <option value="tool.executing">Tools</option>
                <option value="system.ready">System</option>
                <option value="command.response">Responses</option>
            </select>
        </div>
        <div class="logs-scroll" id="logs-scroll">
            <div id="logs-body"></div>
        </div>
    </div>

    <!-- Settings View -->
    <div class="view-overlay" id="settings-view">
        <div class="settings-panel">
            <h2 class="settings-title">SETTINGS</h2>

            <div class="settings-group">
                <label class="settings-label">Memory</label>
                <div class="settings-row">
                    <button id="memory-view" class="settings-btn">View Memories</button>
                    <button id="memory-clear" class="settings-btn danger">Clear All</button>
                </div>
                <div id="memory-output" class="memory-output"></div>
            </div>

            <div class="settings-group">
                <label class="settings-label">Voice Authentication</label>
                <div class="settings-row">
                    <span id="voice-auth-status" class="settings-sub">Checking...</span>
                </div>
                <div class="settings-row">
                    <button id="voice-enroll" class="settings-btn">Enroll Voice</button>
                    <button id="voice-reset" class="settings-btn danger">Reset</button>
                </div>
            </div>

            <div class="settings-group">
                <label class="settings-label">User</label>
                <div class="settings-row">
                    <input type="text" id="user-name-input" class="settings-input" placeholder="Your name">
                    <button id="user-name-save" class="settings-btn">Save</button>
                </div>
            </div>

            <div class="settings-group">
                <label class="settings-label">Cache</label>
                <div class="settings-row">
                    <button id="clear-cache-btn" class="settings-btn">Clear Cache</button>
                    <span id="cache-status" class="settings-sub"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Vision View -->
    <div class="view-overlay" id="vision-view">
        <div class="vision-container">
            <div class="vision-header">
                <div class="view-title">VISION</div>
                <div class="vision-modes">
                    <button class="vision-mode-btn active" data-mode="detect">DETECT</button>
                    <button class="vision-mode-btn" data-mode="segment">SEGMENT</button>
                    <button class="vision-mode-btn" data-mode="classify">CLASSIFY</button>
                </div>
            </div>
            <div class="vision-feed">
                <video id="vision-video" autoplay playsinline muted></video>
                <canvas id="vision-canvas"></canvas>
                <div class="vision-scanline" id="vision-scanline"></div>
                <div class="vision-no-camera" id="vision-no-camera">
                    <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="1"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                    <span>Camera inactive</span>
                </div>
            </div>
            <div class="vision-stats" id="vision-stats">
                <div class="vision-stat">
                    <span class="vision-stat-label">FPS</span>
                    <span class="vision-stat-value" id="vision-fps">0</span>
                </div>
                <div class="vision-stat">
                    <span class="vision-stat-label">INFERENCE</span>
                    <span class="vision-stat-value" id="vision-inference">0ms</span>
                </div>
                <div class="vision-stat">
                    <span class="vision-stat-label">OBJECTS</span>
                    <span class="vision-stat-value" id="vision-objects">0</span>
                </div>
                <div class="vision-stat">
                    <span class="vision-stat-label">CONFIDENCE</span>
                    <span class="vision-stat-value" id="vision-confidence">0%</span>
                </div>
            </div>
            <div class="vision-detections" id="vision-detections"></div>
            <div class="vision-controls">
                <button class="vision-start-btn" id="vision-start-btn">Start Camera</button>
                <div class="vision-slider-group">
                    <label class="vision-slider-label">Confidence: <span id="vision-conf-value">25%</span></label>
                    <input type="range" id="vision-conf-slider" class="vision-slider" min="5" max="95" value="25" step="5">
                </div>
            </div>
        </div>
    </div>

    <!-- Workspace Pane -->
    <div class="workspace-pane" id="workspace-pane">
        <div class="workspace-header">
            <span class="workspace-title">WORKSPACE</span>
            <div class="workspace-controls">
                <button class="workspace-pin" id="workspace-pin" title="Pin open">
                    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2v10M12 22v-6M5 12h14"/><circle cx="12" cy="12" r="2"/></svg>
                </button>
                <button class="workspace-close" id="workspace-close" title="Close">&times;</button>
            </div>
        </div>
        <div class="workspace-output" id="workspace-output"></div>
    </div>

    <!-- History Drawer -->
    <div class="history-drawer" id="history-drawer">
        <div class="history-header">
            <span class="history-title">PROMPT HISTORY</span>
            <button class="history-close" id="history-close">&times;</button>
        </div>
        <div class="history-search">
            <input type="text" id="history-search-input" placeholder="Search history..." autocomplete="off" spellcheck="false">
        </div>
        <div class="history-list" id="history-list"></div>
        <div class="history-footer" id="history-footer">
            <span id="history-stats">No history</span>
            <button class="history-clear-btn" id="history-clear">Clear All History</button>
        </div>
    </div>
    <div class="history-backdrop" id="history-backdrop"></div>

    <script src="js/nex-sounds.js"></script>
    <script src="js/nex-boot.js"></script>
    <script src="js/nex-orb.js"></script>
    <script src="js/nex-dashboard.js"></script>
    <script src="js/nex-services.js"></script>
    <script src="js/nex-logs.js"></script>
    <script src="js/nex-settings.js"></script>
    <script src="js/nex-vision.js"></script>
    <script src="js/nex-conversation.js"></script>
    <script src="js/nex-workspace.js"></script>
    <script src="js/nex-history.js"></script>
</body>
</html>
